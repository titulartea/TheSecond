<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>THE SECOND GALLERY</title>

    <!-- PWA -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#191b2b" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="SECOND" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png" />

    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="header-title">
        <img src="새 폴더\simbol1.png" class="simbol" />
        <h1>THE SECOND GALLERY</h1>
        <img src="새 폴더\simbol1.png" class="simbol" />

        <button id="uploadBtn">👉</button>
      </div>
      <!-- 업로드 모달 열기 -->
      <!-- 알림 설정 버튼 -->
      <button id="notificationSettingsBtn">w</button>
      <!-- 추천 사이트 드롭다운 -->
      <div class="dropdown">
        <button class="dropbtn">+</button>

        <div class="dropdown-content">
          <p style="color: black">추천 사이트</p>
          <a href="https://cactusworld3.netlify.app/" target="_blank"
            >CACTUS WORLD</a
          >
          <a href="https://trashbin.netlify.app/" target="_blank"
            >버려진 작업물들</a
          >
          <a href="#" id="uploadPhotoLink">사진 업로드</a>
        </div>
      </div>
      <div class="btns">
        <button class="cactus" href="https://cactusworld3.netlify.app/">
          <img src="새 폴더\ps.png" class="imgbtn" />
        </button>
        <button class="trashbin" href="https://trashbin.netlify.app/">
          <img src="새 폴더\ai1.png" class="imgbtn" />
        </button>
        <button class="upload" id="uploadPhotoLink">
          <img src="새 폴더\ae.png" class="imgbtn" />
        </button>
      </div>
    </header>

    <!-- 추천 사진 캐러셀 (갤러리 위) -->
    <main>
      <div id="carousel-container">
        <div id="carousel-bg"></div>
        <div id="carousel"></div>
        <button class="carousel-arrow left" id="prevCarousel">❮</button>
        <button class="carousel-arrow right" id="nextCarousel">❯</button>
      </div>

      <!-- 갤러리 -->
      <div class="gallery_container">
        <div id="gallery"></div>
        <button id="loadMoreBtn" style="display: none">+</button>
      </div>
    </main>

    <!-- 통합 업로드/관리 모달 -->
    <div id="mainModal" class="modal">
      <div class="modal-content upload-modal">
        <span class="close" id="closeMainModal">&times;</span>
        <div class="tab-buttons">
          <button class="tab-btn active" data-tab="galleryTab">
            갤러리 업로드
          </button>
          <button class="tab-btn" data-tab="recTab">추천 사진 관리</button>
        </div>
        <!-- 탭: 갤러리 업로드 -->
        <div class="tab-content" id="galleryTab">
          <h2>갤러리 업로드</h2>
          <input
            type="password"
            id="password"
            placeholder="비밀번호를 입력하세요"
          />
          <input type="file" id="fileInput" multiple accept="image/*,video/*" />
          <textarea
            id="description"
            placeholder="사진 소개를 입력하세요"
          ></textarea>
          <div id="uploadProgress" style="display:none; margin:8px 0;">
            <div style="background:#333; border-radius:4px; overflow:hidden; height:20px;">
              <div id="uploadProgressBar" style="background:#41a314; height:100%; width:0%; transition:width 0.3s;"></div>
            </div>
            <p id="uploadProgressText" style="font-size:12px; color:#666; margin:4px 0;"></p>
          </div>
          <button id="submitBtn">업로드</button>
        </div>
        <!-- 탭: 추천 사진 관리 -->
        <div class="tab-content" id="recTab" style="display: none">
          <h2>추천 사진 관리</h2>
          <div class="rec-upload">
            <input
              type="password"
              id="recPassword"
              placeholder="비밀번호를 입력하세요"
            />
            <p style="font-size:13px; color:#888; margin:8px 0 4px;">아래 갤러리에서 추천할 사진을 선택하세요</p>
            <div id="recGalleryPicker" style="max-height:200px; overflow-y:auto; display:grid; grid-template-columns:repeat(auto-fill,minmax(70px,1fr)); gap:4px; border:1px solid #ccc; border-radius:6px; padding:6px; margin-bottom:8px;"></div>
            <button id="submitRecBtn">선택한 사진을 추천에 추가</button>
          </div>
          <div id="recList">
            <!-- 추천 사진 목록은 JS에서 동적으로 생성 -->
          </div>
        </div>
      </div>
    </div>

    <!-- 이미지 확대 모달 -->
    <div id="imageModal" class="modal">
      <div class="modal-content image-modal">
        <!-- 이미지 컨테이너: 이미지와 확대/축소 버튼을 함께 배치 -->
        <div class="image-container">
          <img id="modalImage" src="" alt="확대된 이미지" />
          <!-- 확대/축소 버튼을 우측 상단에 오버레이 -->
          <div id="zoomControls">
            <button id="zoomInBtn">＋</button>
            <button id="zoomOutBtn">－</button>
          </div>
        </div>
        <!-- 이미지 설명 -->
        <p id="imageDescription"></p>
        <!-- 옵션 버튼 및 모달 닫기 -->
        <button
          id="openOptionBtn"
          class="modal-close-btn"
          style="margin-top: 10px"
        >
          :
        </button>
        <button id="closeImageBtn" class="modal-close-btn">⨉</button>
      </div>
      <div class="arrow left" id="prevBtn">❮</div>
      <div class="arrow right" id="nextBtn">❯</div>
    </div>

    <!-- 사진 옵션 모달 (수정/삭제/나가기) -->
    <!-- 사진 옵션 모달 -->
    <div id="photoOptionsModal" style="display: none">
      <!-- 사진 수정/삭제 버튼들 -->
      <button id="btnEditPhoto">사진 소개 수정</button>
      <button id="btnDeletePhoto">사진 삭제</button>
      <!-- 새 사진 파일 변경 버튼 (숨김 파일 입력과 연동) -->
      <input
        type="file"
        id="editFileInput"
        style="display: none"
        accept="image/*,video/*"
      />
      <button id="btnExitOptions">옵션 닫기</button>
    </div>

    <!-- Supabase 라이브러리 및 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script src="script.js"></script>
    <!-- Service Worker 등록 -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("/sw.js").catch(() => {});
      }
    </script>
  </body>
</html>
